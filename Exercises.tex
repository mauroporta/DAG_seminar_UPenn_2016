\pdfoutput=1
%The other issue is that some packages, such as microtype, produce different output under pdflatex. By default the arXiv goes from dvi to ps to pdf, so if you need pdflatex you have to set the \pdfoutput flag in the TeX file.
\newif\ifpersonal
\newif\ifarxiv
\personaltrue % comment to remove personal notes
\arxivtrue % comment to display shortened version for journal submissions
\RequirePackage[l2tabu, orthodox]{nag} %detect whether obsolete packages are used
\documentclass[10pt,a4paper,reqno,oneside]{book} %reqno places equation numbers on the right
\linespread{1.2}
%\allowdisplaybreaks[1]
\usepackage{calligra}
\usepackage{amsmath,amsthm,amssymb,mathrsfs,mathtools,bm,eucal,tensor} % math related
\usepackage{microtype,fixltx2e} % latex technical issues
\usepackage[scaled]{beramono,berasans}
\usepackage{enumerate,comment,braket,xspace,tikz-cd} %utilities
\usepackage[all,cmtip]{xy} % utilities
\usepackage[utf8]{inputenc} % input encoding
\usepackage[T1]{fontenc} % font encoding
\usepackage{lmodern}
\definecolor{linkcolor}{HTML}{005050}
\usepackage[centering,vscale=0.7,hscale=0.7]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage{graphicx}
\usepackage{xparse}
\usepackage{url}

%\makeevenhead{headings}{\thepage}{}{\leftmark}
%\setlrmarginsandblock{3cm}{3.5cm}{*}
%\setlength\marginparwidth{2.5cm}
%\checkandfixthelayout
%
%\setlength\headheight{24pt}

\usepackage{vmargin}
\setpapersize{A4}
\setmarginsrb{25mm}{10mm}{25mm}{10mm}%
{12mm}{10mm}{5mm}{10mm}

\usepackage{fancyhdr}
\pagestyle{fancy}
%%%Settings
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\fancyhf{}
\fancyhead[LE,RO]{\bfseries\thepage}
\fancyhead[RE]{\bfseries\footnotesize\nouppercase{\leftmark}}
\fancyhead[LO]{\bfseries\footnotesize\nouppercase{\rightmark}}

\theoremstyle{plain}
\newtheorem{thm-intro}{Theorem}
\newtheorem{thm}{Theorem}[section]
\newtheorem*{thm*}{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{cor-intro}[thm-intro]{Corollary}
\newtheorem{assumption}[thm]{Assumption}
\theoremstyle{definition}
\newtheorem{defin}[thm]{Definition}
\newtheorem{exercise}[thm]{Exercise}
\newtheorem{defin-intro}[thm-intro]{Definition}
\newtheorem{notation}[thm]{Notation}
\theoremstyle{remark}
\newtheorem*{rem*}{Remark}
\newtheorem{eg}[thm]{Example}
\newtheorem{eg-intro}[thm-intro]{Example}
\newtheorem{rem}[thm]{Remark}
\newtheorem{rem-intro}[thm-intro]{Remark}
\numberwithin{equation}{section}
\newtheorem{construction}[thm]{Construction}

\input{newcommands_all}

\begin{document}

\chapter{$\infty$-category theory}

\section{Motivations}

\begin{exercise}
	We fix a base field $k$.
	Let $X = \mathbb P^1_k$ and let $U_0$ and $U_1$ be the standard open affine cover of $\mathbb P^1_k$.
	For any $k$-algebra $A$, we have:
	\[ U_0(A) \coloneqq \{ [x_0:x_1] \in \mathbb P^1_k(A) \mid x_0 \ne 0\},  \qquad U_1(A) \coloneqq \{[x_0:x_1] \in \mathbb P^1_k(A) \mid x_1 \ne 0\} . \]
	Let $U_{01} = U_0 \cap U_1$ be their intersection.
	Show that the canonical functor
	\[ \rh( \cD(\mathbb P^1_k) ) \to \rh( \cD( U_0 ) ) \times_{\rh( \cD( U_{01} ) )} \rh( \cD( U_1 ) )  \]
	is essentially surjective but not fully faithful.
\end{exercise}

\begin{exercise}
	Let $\cC$ be a triangulated category where countable products and countable direct sums exist.
	Show that if there exists a functor $\mathrm{Tr}$ from the category of arrows $\cC^{\Delta^1}$ to the category of exact triangles in $\cC$, then every triangle in $\cC$ is split.
	(See \cite[Proposition II.1.2.13]{Verdier_Triangulated_categories}.)
\end{exercise}

\section{Reminders on simplicial sets}

\begin{exercise}
	Show that the nerve functor $\mathrm N \colon \Cat \to \sSet$ is fully faithful and its essential image is spanned by those simplicial sets $K$ satisfying the following lifting condition: for every $n \ge 2$ and for every $0 < i < n$ every lifting problem
	\[ \begin{tikzcd}
		\Lambda^n_i \arrow{r} \arrow[hook]{d} & K \\
		\Delta^n \arrow[dashed]{ur}
	\end{tikzcd} \]
	has a unique solution.
\end{exercise}

\ifpersonal
\begin{proof}[Solution]
The nerve of a category $\cC$ is:
\[	(N\cC)_n = \{ (f_1, \dots, f_n) | \text{ composable morphisms} \}.	\]
The face maps are:
\[	d_j (f_1, \dots, f_n) = \left\{ \begin{array} {ll}
(f_1, \dots, f_{n-1}), & j=0 \\
(f_1, \dots, f_j \circ f_{j-1}, \dots, f_n), & 0<j<n \\
(f_2, \dots, f_n), & j=n.
\end{array} \right.	\]
The degeneracy $s_j$ is obtained by inserting an identity map in the $j^{\text{th}}$ slot.

A functor $F : \cC \to \cD$, induces a simplicial map:
\begin{align*}
N(F)_n : (N\cC)_n &\to (N\cD)_n \\
(f_1, \dots, f_n) &\mapsto \big(F(f_1), \dots, F(f_n)\big).
\end{align*}
If two functors $F, F'$ induce simplicial maps $N(F) = N(F')$ which agree, then $F(f) = F'(f)$ for every morphism $f$. Hence
$N$ is faithful. Given a simplicial map $G : N\cC \to N\cD$, we define a functor $F : \cC \to \cD$ to be $G_0$ on objects
and $G_1$ on morphisms. We show that $F$ respects composition. Let $f_1, f_2$ be two composable morphisms in $\cC$ and denote by $x$
the 2-simplex $(f_1, f_2)$. Then:
\[	F(f_2 \circ f_1) = G(d_1 x) = d_1 G(x) = F(f_2) \circ F(f_1).	\]
This proves that $N$ is also full.

We move on to the essential image. Let $K$ be the nerve of a category. The data of a map $\Lambda^n_i \to K$ is the same
as the data of maps $y_j : \Delta^{n-1} \to K$ for $j\neq i$, which are compatible along their faces. By Yoneda, this is the
same as simplices $\{y_j \in K_{n-1} \}_{j\neq i}$ compatible along faces. Given this data, we define the horn filler
$x \in K_n$ by:
\[	x = \left( (d_0)^{n-2}y_{n-1}, (d_0)^{n-3}d_n y_{n-1}, \dots, d_0(d_n)^{n-3}y_{n-1}, (d_n)^{n-2} y_0 \right).	\]
The simplicial identities ensure that $d_j x = y_j$ for $j \neq i$. \footnote{Note that it's essential that both $y_0$ and $y_{n-1}$
	are available to use in the definition of $x$, i.e. that $\Lambda^n_i$ is an inner horn.} Using the compatibility
of the $y_j$ along faces, $x$ is the unique solution to the lifting problem.

Conversely, given a $K$ which has unique solutions to all lifting problems of inner horns, we define a category $\cC$ such
that $K \cong \cC$. Let $K_0$ be the objects of $\cC$, and for $X,Y \in K_0$, define:
\[	\Hom(X,Y) := \{f \in K_1 | d_1f = X, d_0f = Y \}.	\]
Given $f_1 : X \to Y$ and $f_2 : Y \to Z$, define a lifting problem by mapping the 1-simplices $0 \to 1$ and $1\to 2$ in
$\Lambda^2_1$ to $f_1$ and $f_2$, respectively. We define $f_2 \circ f_1$ to be $d_1$ of the unique lift. Associativity
of this composition follows from the unique filling of the horn $\Lambda^3_1$; we don't give the details here.	
\end{proof}
\fi

\begin{exercise}
	Let $S, S'$ be sets, seen as discrete simplicial set.
	Show that any morphism $f \colon S \to S'$ is a Kan fibration, and that $f$ is a trivial Kan fibration if and only if $f$ is a bijection.
\end{exercise}

\ifpersonal
\begin{proof}[Solution]
Since $S$ and $S'$ are sets, all $k$-simplices are of the form $s^k x$, for $x$ a 0-simplex. Given a lifting problem:
	\[ \begin{tikzcd}
		\Lambda^n_i \arrow{r} \arrow[hook]{d} & S\arrow{d}{f} \\
		\Delta^n \arrow[dashed]{ur} \arrow{r} & S'
	\end{tikzcd} \]
all $k$-simplices of $\Lambda^n_i$, for $k>0$, must map to degenerate $k$-simplices in $S$. Hence $\Lambda^n_i$ maps to a
point $s\in S$. Similarly, $\Delta^n$ maps to $f(s)$. The constant map from $\Delta^n$ to $s$ is then the unique 
solution to the lifting problem. It follows that $f$ is a Kan fibration, and moreover that all sets $S$ are $\infty$-groupoids.

By definition, $f$ is a weak equivalence if it induces a weak equivalence on geometric realizations. $|S|$ and $|S'|$ are discrete
topological spaces, therefore $|f|$ is a weak equivalence iff it is a bijection.
\end{proof}
\fi

\begin{exercise}
	Let $G$ and $H$ be simplicial groups and let $f \colon G \to H$ be a surjective group homomorphism.
	Show that $f$ is a Kan fibration.
\end{exercise}

\ifpersonal
\begin{proof}[Solution]
There is an algorithm for constructing fillers on nLab.
\footnote{\url{https://ncatlab.org/nlab/show/simplicial+group}}
We don't have any intuition for it, so we should work on building that.

The algorithm produces unique fillers for all horns, so in particular simplicial groups are $\infty$-groupoids.
\end{proof}
\fi

\begin{exercise}
	Let $\partial \Delta^2$ be the smallest full subsimplicial set of $\Delta^2$ spanned by its non-degenerate edges $\Delta^1 \to \Delta^2$.
	Show that $\partial \Delta^2$ fits into a coequalizer diagram
	\[ (\Delta^0)^{\amalg 6} \rightrightarrows (\Delta^1)^{\amalg 3} \to \partial \Delta^2 . \]
	(Hint: Have a look at \cite[Theorem III.3.1]{Gabriel_Zisman_Calculus_of_fractions}.)
\end{exercise}

\begin{exercise} \label{ex:coskeleton_Kan_complex}
	Let $S$ be a set, seen as a discrete simplicial set.
	Show that $\mathrm{cosk}_n(S)$ satisfies the following property: for every $m \ge n$ and every $0 \le i \le m$ the lifting problem
	\[ \begin{tikzcd}
		\Lambda^n_i \arrow{r} \arrow[hook]{d} & \mathrm{cosk}_n(S) \\
		\Delta^n \arrow[dashed]{ur}
	\end{tikzcd} \]
	has a solution.
	In particular, deduce that $\mathrm{cosk}_0(S)$ is a Kan complex.
\end{exercise}

\begin{proof}
    Recall the definition. Let $tr_{\leq n}:sSet \to sSet_{\leq n}$ be a truncation functor. It has both left adjoint $sk_n$ and right adjoint $cosk_n$ given by left and right Kan extension, respectively. We call $sk_n \circ tr_{\leq n}$ a n-skeleton functor between $sSet$, and $cosk_n \circ tr_{\leq n}$ a n-cosckeleton functor. For the notational convenience, we just denote them by $sk_n$ and $cosk_n$, respectively. \\
    By definition, for every simplicial set $T$, we have an isomorphism 
    \[Hom_{sSet}(T, cosk_n(S)) \simeq Hom_{sSet_{\leq n}}(tr_{\leq n}T, S)\]
    Thus, it suffices to show that there exists a map 
    \[Hom_{sSet_{\leq n}}(\Lambda^m_i, S) \to Hom_{sSet_{\leq n}}(\Delta^m, S)\]
    for every $m \geq n$ and every $0 \leq i \leq m$. It follows from the fact that $S$ is discrete(i.e. Kan complex) and bijectivity of trucation maps. \todo{explain more}
\end{proof}

\section{$\infty$-categories}

\begin{exercise}
	Show that every Kan complexes and $1$-categories are $\infty$-categories (quasicategories).
\end{exercise}

\ifpersonal
\begin{proof}[Solution]
Kan complexes have fillers for all horns. 1-categories have unique fillers for all inner horns. In particular, both have
fillers for all inner horns, which is the definition of $\infty$-categories.
\end{proof}
\fi

\begin{exercise} \label{ex:equivalences_S_infty}
	A morphism $f \colon X \to Y$ in an $\infty$-category $\cC$ is said to be an equivalence if its image in $\rh(\cC)$ is an isomorphism.
	Define $S^\infty \coloneqq \mathrm{cosk}_0(\{0,1\})$ and let $j \colon \Delta^1 \to S^\infty$ be the map classified by
	\[ \mathrm{sk}_0(\Delta^1) = \{0,1\} \xrightarrow{\mathrm{id}} \{0,1\} . \]
	To give a morphism $f \colon X \to Y$ in an $\infty$-category $\cC$ it is equivalent to specify a morphism of simplicial sets $e_f \colon \Delta^1 \to \cC$.
	Show that $f$ is an equivalence if and only if the lifting problem
	\[ \begin{tikzcd}
		\Delta^1 \arrow[hook]{d}{j} \arrow{r}{e_f} & \cC \\
		S^\infty \arrow[dashed]{ur}
	\end{tikzcd} \]
	has at least one solution.
	Next, show that any two such solution are homotopic.
	(Hint: have a look at Exercises \ref{ex:coskeleton_Kan_complex} and \ref{ex:eveloping_groupoid}.)
\end{exercise}

\begin{proof}
    Note that $cosk_n$ is right adjoint to $sk_n$. It follows that $j:\Delta^1 \to S^{\infty}$ is well defined. First, we prove that $f:X \to Y$ is an equivalence if and only if the above lifting problem has at least one solution. By Exercise 1.2.5, $cosk_0(\{0,1\})=S^{\infty}$ is a Kan complex. It means that if we choose Kan model structure on $sSet$, $S^{\infty}$ is a fibrant object. Similar to the exercise 1.3.4, we can say that $j:\Delta^1 \to S^{\infty}$ is a fibrant replacement in $sSet$. It follows from exercise 1.3.4 that we have a functor of $\infty$-categories 
    \[ Fun(S^{\infty}, \cC) \to Fun(\Delta^1, \cC)\]
    which is fully faithful. Also its essential image is spanned by those morphisms $f:\Delta^1 \to \cC$ that send every morphism in $\Delta^1$ into an equivalence in $\cC$. Therefore, $f:X \to Y$ is an equivalence iff $e_f:\Delta^1 \to \cC$ satisfies the above condition iff there exists a map from $S^{\infty} \to \cC$ commuting the above diagram. \\
    Second, we need to show that any two such solution are homotopic. Due to fully faithfulness of the above $\infty$-functor, such two solutions should be isomorphic in the homotopy category of $Fun(S^{\infty}, \cC)$, implying that they are homotopic.
\end{proof}

\begin{exercise}
	In \cite{HTT} a functor of $\infty$-categories $f \colon \cC \to \cD$ is said to be a \emph{categorical equivalence} if and only if the induced functor $\mathfrak C[f] \colon \mathfrak C[\cC] \to \mathfrak C[\cD]$ is an equivalence of simplicial categories.
	Show that $f$ is a categorical equivalence if and only if it is fully faithful and essentially surjective.
\end{exercise}

\begin{proof}
    By definition, $f \colon \cC \to \cD$ is a categorical equivalence if and only if the induced functor $\mathfrak C[f] \colon \mathfrak C[\cC] \to \mathfrak C[\cD]$ is an equivalence of simplicial categories if and only if, by definition, the induced functor $h\mathfrak C[f] \colon h\mathfrak C[\cC] \to h\mathfrak C[\cD]$ on the homotopy level is an equivalence. Also, $h\cC \simeq h\mathfrak C[\cC]$ and this correspondence is functorial. Note that a $\infty$-functor $f$ is defined to be fully faithful(or essentially surjective) if $hf$ is. Thus, it suffices to show that $hf$ is an equivalence iff it is fully faithful and essentially surjective which is obvious.
\end{proof}

\begin{exercise}
	Let $E$ denote the walking isomorphism (i.e.\ the $1$-category with two objects and an isomorphism between them).
	Recall the definition of $S^\infty$ from the previous exercise.
	Show that there is a canonical map $E \to S^\infty$ and that this is a categorical equivalence.
	In particular, for every $\infty$-category $\cC$, the functor
	\[ \Fun(S^\infty, \cC) \to \Fun(E, \cC) \]
	is a categorical equivalence.
	(This is a very simple example of what an ``internal rectification theorem'' looks like.)
\end{exercise}

\begin{proof}
    Similar to the proof of Exercise 1.3.2, it is a consequence Exercise 1.4.1. We can identify $E$ with $\{0,1\}$. The canonical map $E$ is given by one characterized by the identity map $\{0,1\} \to \{0,1\}$. \todo{Categorical equivalence}
    For the categorical equivalence between $\Fun(S^\infty, \cC), \Fun(E, \cC)$, it suffices to show that the given $\infty$-functor is essentially surjective by the virtue of Exercise 1.3.3. We already know that the essential image is spanned by a functor $f:E \to \cC$ that send every morphism in $E$ to an equivalence in $\cC$. Since there is only one morphism, $id:\{0,1\} \to \{0,1\}$ which must be sent to the identity map. Therefore, $\Fun(S^\infty, \cC), \Fun(E, \cC)$ are categorical equivalent.
\end{proof}

\begin{exercise}
	Let $\cC$ be an $\infty$-category.
	Let $S_0$ be a collection of \emph{objects} in $\cC$.
	Let $\cC_0$ be the smallest full subsimplicial set of $\cC$ containing $S_0$ (explicitly, an $n$-simplex $\sigma \colon \Delta^n \to \cC$ belongs to $\cC$ if and only if for every morphism $\Delta^0 \to \Delta^n$ the composition $\Delta^0 \to \Delta^n \xrightarrow{\sigma} \cC$ belongs to $S_0$.)
	Show that $\cC_0$ is an $\infty$-category.
	Furthermore, show that the inclusion $\cC_0 \hookrightarrow \cC$ of simplicial sets is a fully faithful functor of $\infty$-categories.
\end{exercise}

\begin{proof}
    First, we show that $\cC_0$ is $\infty$ category. It suffices to show that for every $n$ and every $0<i<n$, there exists a map $\Delta^n \to \cC$ commuting the following diagram where $\sigma:\Lambda^n_i \to \cC$ belongs to $\cC_0$. Since $\cC$ is $\infty$-category, there exists a map $\tilde{\sigma}:\Delta^n \to \cC$ commuting the diagram. Now, it is enough to show that $\tilde{\sigma}$ belongs to $\cC_0$. Consider the following commutative diagram.
    \[ \begin{tikzcd}
		\Delta^0 \arrow{r} \arrow{dr} & \Lambda^n_i \arrow{r}{\sigma} \arrow[hook]{d} & \cC \\
		{} & \Delta^n \arrow[dashed]{ur}{\tilde{\sigma}} \arrow{ur} & {} 
	\end{tikzcd} \]
	Note that the left triangular diagram commutes since maps from $\Delta^0$ are canonically chosen. Therefore, $\tilde{\sigma}$ belongs to $\cC_0$. \\
	\todo{Show that the inclusion is fully faithful}\\
	idea: homotopy level; directly??
	
\end{proof}

\begin{exercise}
	Let $\cC$ be an $\infty$-category.
	Let $S_0$ be a collection of \emph{morphisms} in $\cC$, and suppose that $S_0$ is closed under composition, in the sense that for every $2$-simplex
	\[ \begin{tikzcd}
	{} & Y \arrow{dr}{g} \\
	X \arrow{ur}{f} \arrow{rr}{h} & & Z
	\end{tikzcd} \]
	is $\cC$, if $f$ and $g$ belong to $S_0$ then so does $h$.
	Let $\cC_0$ be the smallest full subsimplicial set of $\cC$ containing $S_0$ (explicitly, an $n$-simplex $\sigma \colon \Delta^n \to \cC$ belongs to $\cC$ if and only if for every morphism $\Delta^1 \to \Delta^n$ the composition $\Delta^1 \to \Delta^n \xrightarrow{\sigma} \cC$ belongs to $S_0$).
	Show that $\cC_0$ is an $\infty$-category.
\end{exercise}

\begin{proof}
    Similar to the proof of Exercise 1.3.5, we show that $\cC_0$ is $\infty$-category by diagram chasing. We replace $\Delta^0$ in Exercise 1.3.5, by $\Delta^1$ and show that the following diagram commutes for every $n$ and every $0<i<n$;
    \[ \begin{tikzcd}
		\Delta^1 \arrow{r} \arrow{dr} & \Lambda^n_i \arrow{r}{\sigma} \arrow[hook]{d} & \cC \\
		{} & \Delta^n \arrow[dashed]{ur}{\tilde{\sigma}} \arrow{ur} & {} 
	\end{tikzcd} \]
	This is trivial except $n=2$. For $n=2$, we get the following diagram.
	\[ \begin{tikzcd}
		\Delta^1 \arrow{r}{j} \arrow{dr} & \Lambda^2_1 \arrow{r}{\sigma} \arrow[hook]{d} & \cC \\
		{} & \Delta^2 \arrow[dashed]{ur}{\tilde{\sigma}} \arrow{ur} & {} 
	\end{tikzcd} \]
	If $j(\Delta^1)=\{0 \to 1\}$ or $\{1 \to 2\}$, the above diagram commutes again. For $\tilde{\sigma}$ being in $\cC_0$, we need to consider the case where such $j$ does not exist. Namely, we need to show that $\tilde{\sigma} \circ j':\Delta^1 \to \cC$ belongs to $S_0$ where $j':\Delta^1 \to \Delta^2$ is the canonical inclusion with the image $\{0 \to 2\}$. Suppose $\tilde{\sigma}(\Delta^2)$ is the following;
	\[ \begin{tikzcd}
	{} & Y \arrow{dr}{g} \\
	X \arrow{ur}{f} \arrow{rr}{h} & & Z
	\end{tikzcd} \]
	Note that $\tilde{\sigma} \circ j':\Delta^1 \to \cC$ corresponds to $X \xrightarrow{h} Z$. Since $f, g$ are in $S_0$ by assumption and $S_0$ is closed under composition, $\tilde{\sigma} \circ j':\Delta^1 \to \cC$ belongs to $S_0$. Thus, $\cC_0$ is an $\infty$-category. 
\end{proof}

\begin{exercise}
	Let $\cC$ be an $\infty$-category. Show that the collection of equivalences in $\cC$ is closed under composition, in the sense of the previous exercise.
	Let $\cC^{\simeq}$ be the $\infty$-subcategory of $\cC$ spanned by equivalences in $\cC$.
	Show that $\cC^{\simeq}$ is a Kan complex.
\end{exercise}

\begin{proof}
    Let $S_0$ be a collection of equivalences in $\cC$. Suppose we have 2-simplex
    \[ \begin{tikzcd}
	{} & Y \arrow{dr}{g} \\
	X \arrow{ur}{f} \arrow{rr}{\phi} & & Z
	\end{tikzcd} \]
	where $X,Y,Z$ are objects of $\cC$ and $f:X \to Y, g:Y \to Z$ are equivalence in $\cC$. Remind that $f:X \to Y$ is an equivalence if the induced map $hf:hX \to hY$ is an isomorphism in $h\cC$. Since $g \circ f:X \to Z$ is homotopy equivalent to $\phi:X \to Z$ and $h(g\circ f)=hg\circ hf$ is an isomorphism, $\phi:X \to Z$ is an equivalence. Thus, $S_0$ is closed under composition.\\
	Note that for any $\infty$-category $\cD$, $\cD$ is a Kan complex if and only if $\cD$ is an $\infty$-groupoid. \todo{reference-Lurie 1.2.5.1}
	Clearly, $\cC^{\simeq}$ is an $\infty$-groupoid because its homotopy category $h\cC^{\simeq}$ is a groupoid. Therefore, $\cC^{\simeq}$ is a Kan complex. 
	\todo{remark that we can prove this by following the definition. Similar to fill in the horn in exercise 1.2.?}
    
\end{proof}

\section{Localization of $\infty$-categories}

\begin{exercise} \label{ex:eveloping_groupoid}
	Let $\cC$ be an $\infty$-category (seen as a quasicategory).
	Let $\cC \to \widetilde{\cC}$ be a fibrant replacement for the Kan model structure on $\sSet$.
	Show that $\widetilde{\cC}$ enjoys the following universal property: for every $\infty$-category $\cD$ the functor of $\infty$-categories
	\[ \Fun(\widetilde{\cC}, \cD) \to \Fun(\cC, \cD) \]
	is fully faithful and its essential image is spanned by those morphisms $f \colon \cC \to \cD$ that send every morphism in $\cC$ into an equivalence in $\cD$.
	Thus, there is a categorical equivalence $\tilde{\cC} \simeq \cC[W\inv]$, where $W$ denotes the collection of all arrows in $\cC$.
	Deduce that if $\cC$ is an $\infty$-category where every morphism is invertible, then $\cC$ is categorically equivalent to a Kan complex.
\end{exercise}

\begin{proof}
    Let's take the Kan model structure on $sSet$ where cofibrations are levelwise injective morphisms, fibrations are Kan fibrations and weak equivalence is given by weak homotopy equivalence. In this case we have the following property of inner homomorphism $\mathrm{Fun}$;\\
    Suppose that $i \colon A \to B$ is a  cofibration and $p \colon X \to Y$ is a Kan fibration. Then, we have a natural Kan fibration;
    \[ q \colon \mathrm{Fun}(B,X) \to 
    \mathrm{Fun}(A,X) \times_{\mathrm{Fun}(A,Y)} \mathrm{Fun}(B,Y) \]
    
    In particular, if either $i$ or $p$ is a weak equivalence, then $q$ is a trivial fibration. \\
    
    In order to apply this proposition, we need a few observation. First, the fibrant replacement $\cC \to \tilde{\cC}$ is indeed a cofibrant replacement because every object in $sSet$ is cofibrant. Also, given $\cD$, we can take the Kan complex $\cD^{\simeq}$ spanned by equivalence in $\cD$ as in Exercise 1.3.7. Since $\tilde{\cC}$ is a Kan complex, we get the equivalence $\Fun(\tilde{\cC}, \cD) \simeq \Fun(\tilde{\cC}, \cD^{\simeq})$. Now we can apply the above proposition. Take $A=\cC$, $B=\tilde{\cC}$, $X=\cD^{\simeq}$, and $Y=*$. Clearly, $i$ is a weak equivalence. Thus we get the following,
    \[ \begin{tikzcd}
		\Fun(\tilde{\cC},\cD) \arrow{r}{\simeq} & \Fun(\tilde{\cC},\cD^{\simeq}) \arrow{d}{q} & {} \\
		{} & \Fun(\cC, \cD^{\simeq}) &\subseteq \Fun(\cC, \cD) 
	\end{tikzcd} \]
	where $q$ is a weak equivalence. It tells us that the composition is fully faithful and its essential image is $\Fun(\cC, \cD^{\simeq}$. Namely, it is spanned by those morphisms $f:\cC \to \cD$ that send every morphism in $\cC$ into an equivalence in $\cD$. In particular, if $\cC$ is an $\infty$-category where every morphism is invertible, then $\cC \simeq \tilde{\cC}$ hence categorically equivalent to a Kan complex.
\end{proof}

\begin{exercise}
	Let $\cC$ be an $\infty$-category and let $S$ be a (small) collection of arrows in $\cC$.
	Show that $\rh(\cC[S\inv]) \in \Cat$ is canonically equivalent to the $1$-categorical localization of $\rh(\cC)$ at $\overline{S}$, the collection of morphism which is the image of $S$ via the canonical functor $\cC \to \rh(\cC)$.
\end{exercise}

\begin{exercise}
	Let $\cC$ be an $\infty$-category with finite limits and let $S$ be a (small) collection of arrows in $\cC$.
	Suppose that $\cC$ is stable under pullbacks.
	Then the $\infty$-categorical localization $\cC[S\inv]$ has finite limits and the localization functor $L \colon \cC \to \cC[S\inv]$ commutes with them.
\end{exercise}

\section{Limits and colimits}

\begin{exercise}
	Let $\cS$ be the $\infty$-category of spaces and let $X$ be an object in $\cS$.
	Using \cite[Theorem 4.2.4.1]{HTT} show that the colimit of the diagram
	\[ \begin{tikzcd}
		* & X \arrow{l} \arrow{r} & *
	\end{tikzcd} \]
	can be canonically identified with $\Sigma(X)$.
	
	Now fix two points $p, q \colon * \to X$. Show that the limit of the diagram
	\[ \begin{tikzcd}
		* \arrow{r}{p} & X & * \arrow{l}[swap]{q}
	\end{tikzcd} \]
	can be canonically identified with the path space $\mathrm{Path}_X(p,q)$.
\end{exercise}

\begin{exercise}
	$\star$ Prove the following variation of Quillen's theorem A: let $1 \le n \le \infty$ and let $\cC$ be an $(n,1)$-category.
	Let $G \colon I \to J$ be an $\infty$-functor between $\infty$-categories.
	Let $F \colon J \to \cC$ be any other $\infty$-functor.
	Suppose that for every $j \in J$ and any $i \in I_{/j} \coloneqq I \times_J J_{/j}$ one has
	\[ \pi_m( I_{/j}, i ) = 0 \]
	for all $0 \le m \le n-1$ (the above homotopy group is understood to be the homotopy group of the enveloping groupoid of $I_{/j}$).
	Then $F$ admits a limit if and only if $F \circ G$ admits a limit, in which case they coincide.
\end{exercise}

\begin{rem}
	The above version of Quillen's theorem A appears in \cite{MacLane_Categories} for $n = 1$ and in \cite[4.1.3.1]{HTT} for $n = \infty$.
\end{rem}

\begin{exercise}
	Let $\mathbf \Delta_s$ denote the subcategory of $\mathbf \Delta$ spanned by all the objects and only the monomorphisms between them.
	For $n \ge 1$, let $\mathbf \Delta^{\le n}_s$ be the full subcategory of $\mathbf \Delta_s$ spanned by the objects $1, 2, \ldots, n$.
	Prove that for every $n \ge 1$ and every $k \ge 0$ the enveloping groupoid of $(\mathbf \Delta^{\le n}_s)_{/n+k}$ is equivalent to the wedge of a certain number $N_{n,k}$ of $(n-1)$-spheres.\footnote{It should be possible to determine these numbers. We certainly have $N_{n,0} = 1$ and $N_{n,1} = 3$.}
\end{exercise}

\begin{exercise}
	A useful consequence of Quillen's theorem A is the following: let $I$ be a weakly contractible $\infty$-category, by which we mean that the enveloping groupoid of $I$ is weakly contractible. Let $\cC$ be an $\infty$-category and let $x \in \cC$ be an object in $\cC$.
	Let $c_x \colon I \to \cC$ be the constant diagram associated to $x$.
	Then prove that both the limit and the colimit of $c_x$ exists and coincides with $x$.
	
	The above result is false if $I$ is not weakly contractible. Construct a counterexample by choosing $\cC = \cS$, $I = \{\bullet \rightrightarrows \bullet\}$ and $x = *$, the final object of $\cS$. Nevertheless, show that keeping the same $I$ and the same $x$, the result is again true for $\cC = \rSet$. What happens in the $\infty$-category of $n$-homotopy types $\cS^{\le n}$ for general $n$?
\end{exercise}

\begin{exercise}
	$\star$ Let $K$ be a simplicial set and let $F \colon K\op \to \LPr$ be an $\infty$-functor.
	Let $\cC$ be a presentable $\infty$-category and let $\Delta_\cC \colon K\op \to \LPr$ denote the constant $\infty$-functor associated to $F$.
	Let $\varphi \colon \Delta_\cC \to F$ be a natural transformation in $\Fun(K\op, \LPr)$.
	We let
	\[ \Phi \colon \cC \to \varprojlim F \]
	be the induced functor.
	For every $x \in K$, the functor $\varphi_x \colon \cC \to F(x)$ admits a right adjoint, which we denote $\psi_x \colon F(x) \to \cC$.
	Show that there exists an $\infty$-functor
	\[ \overline{\Psi} \colon \varprojlim F \to \Fun(K, \cC) \]
	which informally sends $Y = \{Y_x\}_{x \in K} \in \varprojlim F$ to the diagram $\overline{\Psi}(Y) \colon K \to \cC$ given by
	\[ \overline{\Psi}(Y)(x) = \psi_x(Y_x) . \]
	Prove moreover that the composition
	\[ \begin{tikzcd}
		\varprojlim F \arrow{r}{\overline{\Psi}} & \Fun(K, \cC) \arrow{r}{\mathrm{lim}} & \cC
	\end{tikzcd} \]
	can be canonically identified with a right adjoint for $\Phi$.
\end{exercise}

\section{Left and right fibrations}

\begin{exercise}
	Let $X$ be a connected Kan complex and let $F$ be any other Kan complex.
	Let us further fix a point $x \in X$.
	Let $\mathrm{LF}_x(X;F)$ be the full subcategory of left fibrations $\mathrm{LF}(X)$ over $X$ whose homotopy fiber at $x$ is equivalent to $F$.
	Let $\mathrm{B}(\mathrm{hAut}(F))$ be the classifying space of the simplicial group of homotopy automorphisms of $F$.
	Show that there is a canonical equivalence of $\infty$-categories
	\[ \mathrm{LF}_x(X;F) \simeq \Fun(X, \mathrm{B}(\mathrm{hAut}(F))) . \]
\end{exercise}

\section{Cartesian and coCartesian fibrations}

\begin{exercise}
	Let $\cC$ be an $\infty$-category and let $X \in \cC$ be an object.
	Let $f \colon U \to X$ and $g \colon V \to X$ be two morphisms in $\cC$.
	For every $2$-simplex $\sigma \colon \Delta^2 \to \cC$ such that $d_0(\sigma) = f$ and $d_1(\sigma) = g$, show that there is a pullback square in $\cS$:
	\[ \begin{tikzcd}
		\mathrm{Path}_{\Map_{\cC}(U,X)}(f, d_2(\sigma)) \arrow{r} \arrow{d} & \mathrm{Map}_{\cC_{/X}}(f,g) \arrow{d} \\
		* \arrow{r}{d_2(\sigma)} & \Map_{\cC}(U,V) .
	\end{tikzcd} \]
	(Hint: Use \cite[Propositions 2.1.2.1 and 2.4.4.2]{HTT}.)
\end{exercise}

\section{Adjunctions}

\begin{exercise}
	Let $\cC$ be an $\infty$-category with a zero object $0$.
	Suppose that for every object $X \in \cC$ the span
	\[ 0 \longleftarrow X \longrightarrow 0 \]
	has both a limit $\Omega(X)$ and a colimit $\Sigma(X)$.
	Construct in an explicit way $\infty$-functors $\Sigma, \Omega \colon \cC \to \cC$ informally given by $X \mapsto \Sigma(X)$ and $X \mapsto \Omega(X)$, respectively.
	Show that $\Sigma$ and $\Omega$ are adjoint by explicitly constructing a fibration $\cD \to \Delta^1$ which is both Cartesian and coCartesian.
\end{exercise}

\begin{exercise}
	Let $F \colon \cC \to \cD$ be an $\infty$-functor.
	Show that the following statements are equivalent:
	\begin{enumerate}
		\item $F$ has a right adjoint $G \colon \cD \to \cC$;
		\item for every $Y \in \cD$ there exists an object $X \in \cC$ and a morphism $\varepsilon_X \colon F(X) \to Y$ such that for every other $X' \in \cC$ the canonical composition
		\[ \Map_{\cC}(X',X) \xrightarrow{f} \Map_{\cD}(f(X'), f(X)) \xrightarrow{\varepsilon_{X*}} \Map_{\cD}(f(X'), Y) \]
		is a weak homotopy equivalence.
	\end{enumerate}
\end{exercise}

\section{Stable $\infty$-categories}

\begin{exercise}
	Let $\cC$ be a stable $\infty$-category and let $\cD \subseteq \cC$ be a full stable subcategory of $\cC$.
	Let $S \coloneqq \{f \colon X \to Y \in \cC \mid \mathrm{cofib}(f) \in \cD\}$.
	Show that the $\infty$-categorical localization $\cC[S\inv]$ is a stable $\infty$-category.
\end{exercise}

\begin{exercise}
	It is shown in \cite{Blumberg_Gepner_Universal_2013} that $\Catst$ is a presentable $\infty$-category.
	Prove directly that cofibers in $\Catst$ exist.
\end{exercise}

\chapter{Derived rings}

\section{Derived rings}

\begin{exercise}
	Show that a discrete commutative ring $A$ over $k$ is finitely presented if and only if its associated corepresentable functor
	\[ \Hom_{\CAlg_k}(A,-) \colon \CAlg_k \to \rSet \]
	commutes with filtered colimits.
\end{exercise}

\begin{exercise}
	Let $A \in \mathrm{sCAlg}_k$ and let $M \in A\Mod^{\le 0}$.
	Show that the diagram
	\[ \begin{tikzcd}
		\Sym_A(M) \arrow{r} \arrow{d} & A \arrow{d} \\
		A \arrow{r} & \Sym_A(M[1])
	\end{tikzcd} \]
	is a (homotopy) pushout square (where the two maps $\Sym_A(M) \to A$ are both classified by the zero map $M \to A$, and where both the maps $A \to \Sym_A(M[1])$ are the structure morphisms).
\end{exercise}

\begin{exercise}
	Let $A \in \mathrm{sCAlg}_k$ and let $M \in A \Mod^{\le 0}$.
	Let $A \oplus M$ denote the split square-zero extension of $A$ by $M$.
	Show that the diagram
	\[ \begin{tikzcd}
		A \oplus M \arrow{r} \arrow{d} & A \arrow{d}{d_0} \\
		A \arrow{r}{d_0} & A \oplus M[1]
	\end{tikzcd} \]
	is a homotopy pullback, where $d_0 \colon A \to A \oplus M[1]$ is the morphism classifying the zero derivation.
\end{exercise}

\section{Modules}

\begin{exercise}
	Let $A$ be a discrete commutative ring over $k$.
	Show that $M \in A\Modh$ is finitely generated if and only if its associated corepresentable functor
	\[ \Hom_{A\Modh}(M,-) \colon A \Modh \to \rSet \]
	commutes with filtered colimits of monomorphisms.
\end{exercise}

\begin{exercise}
	Let $A$ be a discrete commutative ring over $k$.
	Show that $M \in A \Modh$ is finitely presented if and only if its associated corepresentable functor
	\[ \Hom_{A\Modh}(M,-) \colon A \Modh \to \rSet \]
	commutes with filtered colimits.
\end{exercise}

\section{Cotangent complex}

\begin{exercise}
\label{ex:cotangent_comp}
	Compute the cotangent complex of the following morphisms:
	\begin{enumerate}
		\item $k \to k[\varepsilon] / (\varepsilon^2)$, $\deg(\varepsilon) = 0$;
		\item $k[X,Y] \to k[X,Y] / (Y^3 - X^2)$;
		\item $k \to k[X,Y] / (Y^3 - X^2)$.
	\end{enumerate}
\end{exercise}

\begin{exercise}
	Find all the square-zero extensions (up to homotopy) of $R \coloneqq k[\varepsilon] / (\varepsilon^2)$ by $k \simeq R / (\varepsilon)$.
	What happens if we replace $k$ by $k[n]$, $n \ge 0$?
\end{exercise}

\ifpersonal
\begin{proof}[Solution]
We could work with the cotangent complex of $k \to k[\varepsilon]/(\varepsilon^2)$, as computed in Exercise \ref{ex:cotangent_comp}.
Instead, we work straight from the definition, in order to get a more explicit understanding of the extensions. Recall that square
zero extensions up to homotopy are:
\begin{equation}
\label{eq:ext_need_cofibrant}
	\pi_0 \Map_{cdga_k^{\leq 0} / k[\varepsilon]/(\varepsilon^2)} \big( k[\varepsilon]/(\varepsilon^2) ,
k[\varepsilon]/(\varepsilon^2) \oplus k[1] \big).
\end{equation}
Note that mapping spaces are \emph{not} homotopy invariant; in order to obtain the correct answer, we need to take a cofibrant
replacement of the first variable and a fibrant replacement of the second, in the category 
$cdga_k^{\leq 0} / k[\varepsilon]/(\varepsilon^2)$. Recall that the model structure on $cdga_k$ is obtained via transfer
from the model structure on $Chain_k$; in particular:
\begin{itemize}
\item Fibrations are the same as those of the underlying complexes, i.e. the degree-wise surjections. All objects are fibrant.
\item Cofibrations $f:A \to B$ are the morphisms such that $B$ is quasi-free over $A$. The cofibrant objects
are cdga's which are quasi-free over $k$.
\end{itemize}
Therefore, to describe the square-zero extensions given by \ref{eq:ext_need_cofibrant}, it suffices to take a k-free resolution
of $k[\varepsilon]/(\varepsilon^2)$. This is accomplished by:
\[
\begin{tikzcd}
0 \arrow{r} & k[\varepsilon]\arrow{r}{\varepsilon^2} & k[\varepsilon]\arrow{r} & 0 .
\end{tikzcd}
\]
Of course, one needs to check that this gives indeed a cdga.
\begin{itemize}
\item For $|a| = |b| = 0$, $ab$ is ring multiplication in $k[\varepsilon]$.
\item For $|a| = 0, |b| = 1$, $ab$ is ring multiplication in $k[\varepsilon]$.
\item For $|a| = |b| = 1$, $|ab| = 2$, so the only possibility is $ab = 0$.
\item Let's check that multiplication by $\varepsilon^2$ satisfies the Leibniz rule. We do this for $|a| = 0, |b| = 1$:
\[ \varepsilon^2(a) \cdot b + (-1)^{|a|} a \varepsilon^2(b) = 0 \cdot b + (-1)^0 a \varepsilon^2 b = \varepsilon^2 (ab). \]
\end{itemize}

With this cofibrant model, we compute \ref{eq:ext_need_cofibrant}. These are maps between cdga's, and we identify them
by their components:
\[
\begin{tikzcd}
k[\varepsilon]\arrow[swap]{d}{\eta}\arrow{r}{\varepsilon^2} & k[\varepsilon]\arrow{d}{p} \\
k\arrow{r}{0} & k[\varepsilon]/(\varepsilon^2) .
\end{tikzcd}
\]
But, since we are working in the comma category of cdga's over $k[\varepsilon]/(\epsilon^2)$, the map $p$ is forced to be
the canonical projection $k[\varepsilon] \to k[\varepsilon]/(\varepsilon^2)$. It follows that the only freedom is in choosing
$\eta$. The constraints on $\eta$ are given by the fact that a morphism of cdga's must commute with the cdga multiplication, in
the sense that, for $|f| = 0$ and $|g| = 1$, $\eta(fg) = p(f)\eta(g)$. In particular:
\[	\eta(\varepsilon) = \eta(1\cdot \varepsilon) = p(\varepsilon)\cdot \eta(1) = \varepsilon \cdot \eta(1) = 0,	\]
because $\epsilon$ acts by 0 on $k = k[\varepsilon]/(\varepsilon)$. Similarly, $\eta(\epsilon^i) = 0$ for all $i>0$. It follows
that, if $|g| = 1$ with $g = \alpha_0 + \alpha_1 \varepsilon + \dots$, then $\eta(g) = \lambda \alpha_0$, for some $\lambda \in
k$. Thus, elements of \ref{eq:ext_need_cofibrant} are classified by $\lambda \in k$.\footnote{We point out that, had we not
used a cofibrant replacement for $k[\varepsilon]/(\varepsilon^2)$, we would obtain $(0,\id)$ as the only map of cdga's; this
corresponds to the zero derivation. This answer is clearly wrong, as it doesn't account for the square-zero extension
$k[\varepsilon]/(\varepsilon^3) \to k[\varepsilon]/(\varepsilon^2)$.}

To see the square-zero extensions explicitly, we need to compute the homotopy fiber products:
\[
\begin{tikzcd}
A^{\eta}\arrow[dashed]{r}\arrow[dashed]{d} & k[\varepsilon]/(\varepsilon^2)\arrow{d}{d_{\eta}} \\
k[\varepsilon]/(\varepsilon^2) \arrow{r}{d_0} & k[\varepsilon]/(\varepsilon^2) \oplus k[1] .
\end{tikzcd}
\]
Homotopy fiber products \emph{are} homotopy invariant, so this is the same as computing the homotopy fiber products:
\[
\begin{tikzcd}
&
k[\varepsilon]
%\ar{dl}[swap, sloped, near start]{t}
\ar{rr}{\varepsilon^2}
\ar[]{dd}[near end]{\eta}
& & k[\varepsilon]
\ar{dd}{p}
%\ar{dl}[swap, sloped, near start]{}
\\
A
\ar[crossing over,dashed]{rr}[near end]{\phi}
\ar[swap,dashed]{dd}
\ar[dashed]{ur}
& & B \ar[dashed]{ur}\ar[dashed]{dd}
\\
&
k
\ar[near start]{rr}{0}
& & k[\varepsilon]/(\varepsilon^2)
\\
k[\varepsilon]
\ar{rr}{\varepsilon^2}
\ar{ur}{0}
& & k[\varepsilon]
%\ar[crossing over, leftarrow, near start]{uu}{}
\ar{ur}{p}
\end{tikzcd}
\]
The advantage of using this model is that the maps on the right face of the cube are degree-wise surjections, hence fibrations,
so it suffices to compute the naive fiber product. This gives:
\begin{align*}
A &= k[\varepsilon] \oplus (\varepsilon) k[\varepsilon], \\
B &=  k[\varepsilon] \oplus  (\varepsilon^2) k[\varepsilon], \\
\phi &= (\varepsilon^2, \varepsilon^2).
\end{align*}
Note first that $\phi$ is injective, so the homotopy fiber product is (cohomologically) concentrated in degree 0. In other words,
it is quasi-isomorphic as cdga to:
\[	0 \to 0 \to k[\varepsilon]/(\varepsilon^2) \oplus k \to 0.	\]
It remains to see how the choice of $\lambda \in k$ determines the product structure on $k[\varepsilon]/(\varepsilon^2) \oplus k$.
The claim is that we get:
\[	(a + b \varepsilon, c) \cdot_{\lambda} (a' + b' \varepsilon, c') = 
\big(aa' + (a'b + ab')\varepsilon, \lambda bb' + ac' + ca' \big)	\]
Note that for $\lambda = 1$ this is just the ring multiplication in $k[\varepsilon]/(\varepsilon^3)$, so we recover the
classical square-zero extension $k[\varepsilon]/(\varepsilon^3) \to k[\varepsilon]/(\varepsilon^2)$.
\todo{I actually don't understand how we get this product structure in degree 0, given that the only freedom is in the map $\eta$,
which goes between the degree -1 parts.}
\end{proof}
\fi

\chapter{Derived stacks}



\bibliographystyle{plain}
\bibliography{dahema}

\end{document}
